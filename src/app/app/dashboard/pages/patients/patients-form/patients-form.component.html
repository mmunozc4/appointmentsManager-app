<div class="modal-backdrop">
    <div class="modal">
        <header class="modal-header">
            <h3>{{ prefill ? 'Editar paciente' : 'Nuevo paciente' }}</h3>
            <button class="close" (click)="close()">✕</button>
        </header>

        <form (ngSubmit)="submit()" [formGroup]="patientForm" class="form-grid" novalidate>
            <div class="col">
                <label>Nombre *</label>
                <input formControlName="name" [class.invalid]="submitted && f['name'].invalid" />
                <div class="error" *ngIf="submitted && f['name'].errors">
                    <small *ngIf="f['name'].errors['required']">El nombre es obligatorio.</small>
                    <small *ngIf="f['name'].errors['minlength']">Debe tener al menos 3 caracteres.</small>
                </div>
            </div>

            <div class="col">
                <label>Teléfono *</label>
                <input formControlName="mobileNo" [class.invalid]="submitted && f['mobileNo'].invalid" />
                <div class="error" *ngIf="submitted && f['mobileNo'].errors">
                    <small *ngIf="f['mobileNo'].errors['required']">El teléfono es obligatorio.</small>
                    <small *ngIf="f['mobileNo'].errors['pattern']">Formato inválido, solo números (7-15
                        dígitos).</small>
                </div>
            </div>

            <div class="col">
                <label>Ciudad</label>
                <input formControlName="city" />
            </div>

            <div class="col">
                <label>Edad</label>
                <input type="number" formControlName="age" [class.invalid]="submitted && f['age'].invalid" />
                <div class="error" *ngIf="submitted && f['age'].errors">
                    <small *ngIf="f['age'].errors['min']">La edad no puede ser negativa.</small>
                    <small *ngIf="f['age'].errors['max']">La edad no puede superar 120 años.</small>
                </div>
            </div>

            <div class="col">
                <label>Género</label>
                <select formControlName="gender">
                    <option value="">—</option>
                    <option value="Masculino">Masculino</option>
                    <option value="Femenino">Femenino</option>
                    <option value="Otro">Otro</option>
                </select>
            </div>

            <div class="actions full">
                <button type="submit" [disabled]="loading">Guardar</button>
                <button type="button" (click)="close()">Cancelar</button>
            </div>
        </form>
    </div>
</div>